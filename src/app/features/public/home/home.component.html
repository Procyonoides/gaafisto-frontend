<div class="home-container">
    <!-- Banner Slider -->
    <section class="banner-section">
        <div class="container">
            <div class="row">
                <div class="col-md-9">
                    <div class="main-banner">
                        <div class="banner-slide active">
                            <img src="assets/images/banner1.jpg" alt="Banner 1" 
                                 onerror="this.src='https://via.placeholder.com/870x320/667eea/ffffff?text=Flash+Sale+Up+to+80%25'">
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="side-banner mb-3">
                        <img src="assets/images/side1.jpg" alt="Side 1" 
                             onerror="this.src='https://via.placeholder.com/270x150/764ba2/ffffff?text=New+Arrivals'">
                    </div>
                    <div class="side-banner">
                        <img src="assets/images/side2.jpg" alt="Side 2" 
                             onerror="this.src='https://via.placeholder.com/270x150/667eea/ffffff?text=Free+Shipping'">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="categories-grid">
        <div class="container">
            <h2 class="section-title">Browse by Category</h2>
            <div class="row">
                <div class="col-6 col-md-2 mb-3" *ngFor="let category of categories">
                    <div class="category-item" (click)="filterByCategory(category.name)">
                        <div class="category-icon">
                            <i [class]="category.icon"></i>
                        </div>
                        <p>{{ category.name }}</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Flash Sale Section -->
    <section class="flash-sale-section">
        <div class="container">
            <div class="section-header">
                <h2><i class="fa fa-bolt"></i> Flash Sale</h2>
                <a routerLink="/products" class="view-all">View All <i class="fa fa-chevron-right"></i></a>
            </div>
            
            <!-- Loading State -->
            <div *ngIf="loading && flashSaleProducts.length === 0" class="text-center py-4">
                <div class="spinner-border text-primary"></div>
            </div>

            <!-- Empty State -->
            <div *ngIf="!loading && flashSaleProducts.length === 0" class="text-center py-4">
                <p class="text-muted">No flash sale products available</p>
            </div>
            
            <!-- Products Grid -->
            <div class="products-grid" *ngIf="flashSaleProducts.length > 0">
                <div class="product-item" *ngFor="let product of flashSaleProducts">
                    <!-- Discount Badge -->
                    <div class="product-badge" *ngIf="product.discount && product.discount > 0">
                        <span class="discount-badge">-{{ product.discount }}%</span>
                    </div>
                    
                    <!-- Product Image Link -->
                    <a [routerLink]="['/products', product.itemId]">
                        <div class="product-image">
                            <img [src]="getImageUrl(product.cover)" 
                                 [alt]="product.name" 
                                 onerror="this.src='https://via.placeholder.com/200x200/667eea/ffffff?text=No+Image'">
                        </div>
                    </a>
                    
                    <!-- Product Info -->
                    <div class="product-info">
                        <h6 class="product-name">
                            <a [routerLink]="['/products', product.itemId]">{{ product.name }}</a>
                        </h6>
                        <div class="product-price">
                            <span class="current-price">Rp {{ formatPrice(product.price) }}</span>
                        </div>
                        <div class="product-stats">
                            <span class="rating">
                                <i class="fa fa-star"></i> {{ product.averageRating || 0 }}
                            </span>
                            <span class="sold">{{ (product.sold || 0) }} sold</span>
                        </div>
                    </div>
                    
                    <!-- Add to Cart Button -->
                    <button class="btn-add-cart" 
                            (click)="addToCart(product)" 
                            [disabled]="product.stock === 0"
                            [title]="product.stock === 0 ? 'Out of stock' : 'Add to cart'">
                        <i class="fa fa-shopping-cart"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- All Products Section -->
    <section class="all-products-section">
        <div class="container">
            <div class="section-header">
                <h2>Recommended Products</h2>
                <div class="filter-tabs">
                    <button class="tab-btn active" (click)="sortBy('popular')">Popular</button>
                    <button class="tab-btn" (click)="sortBy('latest')">Latest</button>
                    <button class="tab-btn" (click)="sortBy('price-low')">Price: Low to High</button>
                    <button class="tab-btn" (click)="sortBy('price-high')">Price: High to Low</button>
                </div>
            </div>

            <!-- Loading State -->
            <div *ngIf="loading" class="text-center py-5">
                <div class="spinner-border text-primary"></div>
                <p class="mt-3 text-muted">Loading products...</p>
            </div>

            <!-- Empty State -->
            <div *ngIf="!loading && products.length === 0" class="text-center py-5">
                <i class="fa fa-box-open fa-4x text-muted mb-3"></i>
                <h4>No products available</h4>
                <p class="text-muted">Check back later for new arrivals</p>
            </div>

            <!-- Products Grid -->
            <div class="products-grid" *ngIf="!loading && products.length > 0">
                <div class="product-item" *ngFor="let product of products">
                    <!-- Product Image Link -->
                    <a [routerLink]="['/products', product.itemId]">
                        <div class="product-image">
                            <img [src]="getImageUrl(product.cover)" 
                                 [alt]="product.name"
                                 onerror="this.src='https://via.placeholder.com/200x200/667eea/ffffff?text=No+Image'">
                        </div>
                    </a>
                    
                    <!-- Product Info -->
                    <div class="product-info">
                        <h6 class="product-name">
                            <a [routerLink]="['/products', product.itemId]">{{ product.name }}</a>
                        </h6>
                        <div class="product-price">
                            <span class="current-price">Rp {{ formatPrice(product.price) }}</span>
                        </div>
                        <div class="product-stats">
                            <span class="rating">
                                <i class="fa fa-star"></i> {{ product.averageRating || 0 }}
                            </span>
                            <span class="location">
                                <i class="fa fa-map-marker-alt"></i> Jakarta
                            </span>
                        </div>
                    </div>
                    
                    <!-- Add to Cart Button -->
                    <button class="btn-add-cart" 
                            (click)="addToCart(product)" 
                            [disabled]="product.stock === 0"
                            [title]="product.stock === 0 ? 'Out of stock' : 'Add to cart'">
                        <i class="fa fa-shopping-cart"></i>
                    </button>
                </div>
            </div>

            <!-- View All Button -->
            <div class="text-center mt-4" *ngIf="products.length > 0">
                <a routerLink="/products" class="btn btn-outline-primary btn-lg">
                    View All Products <i class="fa fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </section>
</div>